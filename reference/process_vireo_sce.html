<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>process_vireo_sce: Integrate Vireo donor assignments with a SingleCellExperiment object — process_vireo_sce • variantCell</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="process_vireo_sce: Integrate Vireo donor assignments with a SingleCellExperiment object — process_vireo_sce"><meta property="og:description" content="Processes donor genetic identity data from Vireo and integrates it with a SingleCellExperiment
object's metadata. The function adds donor assignments to the colData, matches cell identifiers
between Vireo output and the SCE object, and generates summary statistics of cell type
distributions per donor."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">variantCell</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/build_snp_database.html">Building the SNP database</a>
    </li>
    <li>
      <a href="../articles/cell_level_DE.html">Cell-level DE SNP Analsyis</a>
    </li>
    <li>
      <a href="../articles/donor_recipient.html">Determining Donor and Recipient Cells</a>
    </li>
    <li>
      <a href="../articles/group_level_DE.html">Group-level DE SNP Analsyis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>process_vireo_sce: Integrate Vireo donor assignments with a SingleCellExperiment object</h1>

    <div class="hidden name"><code>process_vireo_sce.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Processes donor genetic identity data from Vireo and integrates it with a SingleCellExperiment
object's metadata. The function adds donor assignments to the colData, matches cell identifiers
between Vireo output and the SCE object, and generates summary statistics of cell type
distributions per donor.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-sce-obj">sce_obj<a class="anchor" aria-label="anchor" href="#arg-sce-obj"></a></dt>
<dd><p>A SingleCellExperiment object. The single-cell dataset to be annotated with
donor information.</p></dd>


<dt id="arg-vireo-path">vireo_path<a class="anchor" aria-label="anchor" href="#arg-vireo-path"></a></dt>
<dd><p>Character. Path to the Vireo donor_ids.tsv file containing donor assignments.</p></dd>


<dt id="arg-prefix-text">prefix_text<a class="anchor" aria-label="anchor" href="#arg-prefix-text"></a></dt>
<dd><p>Character. Text to prepend to cell identifiers in the Vireo data to match
the cell barcodes in the SingleCellExperiment object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing:</p>
<dl><dt>sce_object</dt>
<dd><p>The SingleCellExperiment object with donor assignment metadata added</p></dd>

<dt>donor_data</dt>
<dd><p>Data frame containing donor assignments for matched cells</p></dd>

<dt>matching_cells</dt>
<dd><p>Character vector of cell identifiers that matched between SCE and Vireo</p></dd>

<dt>summaries</dt>
<dd><p>List of summary statistics including:</p><ul><li><p>donor_summaries: Per-donor cell counts and cell type distributions (if available)</p></li>
<li><p>cells_matched: Total number of cells successfully matched</p></li>
<li><p>total_sce_cells: Total number of cells in the SingleCellExperiment object</p></li>
<li><p>total_vireo_cells: Total number of cells in the Vireo data</p></li>
</ul></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function first processes the Vireo TSV file using the <code>process_tsv</code> function,
adding the prefix to cell identifiers. It then adds the donor assignments to the
SingleCellExperiment object's colData and generates summary statistics of cell type
distributions for each donor (if cell_type information is available in colData).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The function checks for a "cell_type" column in the SingleCellExperiment object's colData.
If present, it will generate cell type distribution summaries per donor. If not, the
cell_types field in donor_summaries will be NULL.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Process a SingleCellExperiment object with Vireo donor assignments</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">process_vireo_sce</span><span class="op">(</span></span></span>
<span class="r-in"><span>  sce_obj <span class="op">=</span> <span class="va">my_sce_object</span>,</span></span>
<span class="r-in"><span>  vireo_path <span class="op">=</span> <span class="st">"path/to/vireo/donor_ids.tsv"</span>,</span></span>
<span class="r-in"><span>  prefix_text <span class="op">=</span> <span class="st">"Patient1_Sample3_"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access the updated SingleCellExperiment object</span></span></span>
<span class="r-in"><span><span class="va">updated_sce</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">sce_object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check matching statistics</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">summaries</span><span class="op">$</span><span class="va">cells_matched</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">summaries</span><span class="op">$</span><span class="va">total_sce_cells</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrew Potter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

