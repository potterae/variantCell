<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>findDESNPs: Cell-Level Differential SNP Expression Analysis — findDESNPs • variantCell</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="findDESNPs: Cell-Level Differential SNP Expression Analysis — findDESNPs"><meta property="og:description" content="Identifies differentially expressed SNPs between cell populations by comparing read depths
and alternative allele frequencies. This function performs comprehensive statistical analysis
at the single-cell level, with support for parallel processing to improve performance on large datasets."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">variantCell</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/build_snp_database.html">Building the SNP database</a>
    </li>
    <li>
      <a href="../articles/cell_level_DE.html">Cell-level DE SNP Analsyis</a>
    </li>
    <li>
      <a href="../articles/donor_recipient.html">Determining Donor and Recipient Cells</a>
    </li>
    <li>
      <a href="../articles/group_level_DE.html">Group-level DE SNP Analsyis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>findDESNPs: Cell-Level Differential SNP Expression Analysis</h1>

    <div class="hidden name"><code>findDESNPs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identifies differentially expressed SNPs between cell populations by comparing read depths
and alternative allele frequencies. This function performs comprehensive statistical analysis
at the single-cell level, with support for parallel processing to improve performance on large datasets.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ident-">ident.1<a class="anchor" aria-label="anchor" href="#arg-ident-"></a></dt>
<dd><p>Character. Primary cell identity to analyze.</p></dd>


<dt id="arg-ident-">ident.2<a class="anchor" aria-label="anchor" href="#arg-ident-"></a></dt>
<dd><p>Character, optional. Secondary cell identity to compare against.
If NULL, compares against all other cells.</p></dd>


<dt id="arg-donor-type">donor_type<a class="anchor" aria-label="anchor" href="#arg-donor-type"></a></dt>
<dd><p>Character, optional. Donor type to restrict analysis to ("Donor" or "Recipient").
If NULL, uses all cells regardless of donor type.</p></dd>


<dt id="arg-use-normalized">use_normalized<a class="anchor" aria-label="anchor" href="#arg-use-normalized"></a></dt>
<dd><p>Logical. Whether to use normalized depth counts (TRUE) or raw counts (FALSE).</p></dd>


<dt id="arg-min-expr-cells">min_expr_cells<a class="anchor" aria-label="anchor" href="#arg-min-expr-cells"></a></dt>
<dd><p>Integer. Minimum number of expressing cells required in each group.</p></dd>


<dt id="arg-min-alt-frac">min_alt_frac<a class="anchor" aria-label="anchor" href="#arg-min-alt-frac"></a></dt>
<dd><p>Numeric between 0 and 1. Minimum alternative allele fraction to consider a cell as expressing.</p></dd>


<dt id="arg-logfc-threshold">logfc.threshold<a class="anchor" aria-label="anchor" href="#arg-logfc-threshold"></a></dt>
<dd><p>Numeric. Minimum absolute log2 fold-change required to report a SNP.</p></dd>


<dt id="arg-calc-p">calc_p<a class="anchor" aria-label="anchor" href="#arg-calc-p"></a></dt>
<dd><p>Logical. Whether to calculate p-values (Wilcoxon test). Set to FALSE to save computation time.</p></dd>


<dt id="arg-p-adjust-method">p.adjust.method<a class="anchor" aria-label="anchor" href="#arg-p-adjust-method"></a></dt>
<dd><p>Character. Method for p-value adjustment, passed to p.adjust(). Default: "BH" (Benjamini-Hochberg).</p></dd>


<dt id="arg-return-all">return_all<a class="anchor" aria-label="anchor" href="#arg-return-all"></a></dt>
<dd><p>Logical. Whether to return all SNPs or only significant ones.</p></dd>


<dt id="arg-pseudocount">pseudocount<a class="anchor" aria-label="anchor" href="#arg-pseudocount"></a></dt>
<dd><p>Numeric. Value added to expression values before log transformation.</p></dd>


<dt id="arg-min-p">min.p<a class="anchor" aria-label="anchor" href="#arg-min-p"></a></dt>
<dd><p>Numeric. Minimum p-value to report (prevents numerical underflow).</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>Logical. Whether to print debugging information during analysis.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer, optional. Number of CPU cores to use for parallel processing.
If NULL, automatically uses detectCores() - 1.</p></dd>


<dt id="arg-use-parallel">use_parallel<a class="anchor" aria-label="anchor" href="#arg-use-parallel"></a></dt>
<dd><p>Logical. Whether to implement parallel processing.</p></dd>


<dt id="arg-chunk-size">chunk_size<a class="anchor" aria-label="anchor" href="#arg-chunk-size"></a></dt>
<dd><p>Integer.   Number of SNPs to process in each batch during parallel execution.
Larger values may improve performance but require more memory.</p></dd>


<dt id="arg-max-ram-gb">max_ram_gb<a class="anchor" aria-label="anchor" href="#arg-max-ram-gb"></a></dt>
<dd><p>Numeric.  Maximum RAM usage estimate in gigabytes for parallel processing.
The function will automatically reduce chunk_size if estimated memory usage
would exceed this limit.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>List containing:</p>
<dl><dt>results</dt>
<dd><p>Data frame of differentially expressed SNPs with metrics including log2FC,
expression values, cell counts, and significance statistics.</p></dd>

<dt>summary</dt>
<dd><p>List with analysis overview, including counts of significant SNPs,
up/downregulated SNPs, and parameter settings used.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function calculates differential expression by comparing the average expression
of SNPs between two groups, normalized by the total number of cells in each group.
For each SNP, cells are only considered as expressing if they have a minimum
alternative allele fraction (min_alt_frac) and positive read depth.</p>
<p>Statistical testing is performed using Wilcoxon rank-sum test when calc_p=TRUE.
Multiple testing correction is applied using the specified p.adjust.method.</p>
<p>The parallel implementation distributes SNP processing across multiple CPU cores
for significantly improved performance on large datasets.</p>
    </div>
    <div id="note">
    <h2>Note</h2>

<ul><li><p>Requires package 'parallel', 'foreach', and 'doParallel' for parallel processing</p></li>
<li><p>Project identity must be set before using this function via setProjectIdentity()</p></li>
<li><p>For non-transplant datasets, donor_type filtering is automatically disabled</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="setProjectIdentity.html">setProjectIdentity</a></code> for setting the cell identity to use
<code><a href="findSNPsByGroup.html">findSNPsByGroup</a></code> for group-level SNP analysis</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Initialize a variantCell project</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">proj</span><span class="op">$</span><span class="fu">setProjectIdentity</span><span class="op">(</span><span class="st">'cell_type'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic usage comparing T cells vs other cells, donor cells only</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">proj</span><span class="op">$</span><span class="fu">findDESNPs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ident.1 <span class="op">=</span> <span class="st">"T_cells"</span>,</span></span>
<span class="r-in"><span>  ident.2 <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  donor_type <span class="op">=</span> <span class="st">"Donor"</span>,</span></span>
<span class="r-in"><span>  min_expr_cells <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  logfc.threshold <span class="op">=</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Without p-value calculation for faster processing</span></span></span>
<span class="r-in"><span><span class="va">fast_results</span> <span class="op">&lt;-</span> <span class="va">proj</span><span class="op">$</span><span class="fu">findDESNPs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ident.1 <span class="op">=</span> <span class="st">"CD4"</span>,</span></span>
<span class="r-in"><span>  ident.2 <span class="op">=</span> <span class="st">"CD8"</span>,</span></span>
<span class="r-in"><span>  calc_p <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  n_cores <span class="op">=</span> <span class="fl">8</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">summary</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrew Potter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

