<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>plotSNPHeatmap: Create a heatmap visualization of SNP expression across cell groups — plotSNPHeatmap • variantCell</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="plotSNPHeatmap: Create a heatmap visualization of SNP expression across cell groups — plotSNPHeatmap"><meta property="og:description" content="This function generates a heatmap visualization of SNP expression data across different cell
groups, with optional splitting by an additional variable. It aggregates SNP read counts within
each group and can filter based on alternative allele frequency thresholds. The resulting
heatmap shows expression patterns with gene-based row annotation and clustering options."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">variantCell</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/build_snp_database.html">Building the SNP database</a>
    </li>
    <li>
      <a href="../articles/cell_level_DE.html">Cell-level DE SNP Analsyis</a>
    </li>
    <li>
      <a href="../articles/donor_recipient.html">Determining Donor and Recipient Cells</a>
    </li>
    <li>
      <a href="../articles/group_level_DE.html">Group-level DE SNP Analsyis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>plotSNPHeatmap: Create a heatmap visualization of SNP expression across cell groups</h1>

    <div class="hidden name"><code>plotSNPHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function generates a heatmap visualization of SNP expression data across different cell
groups, with optional splitting by an additional variable. It aggregates SNP read counts within
each group and can filter based on alternative allele frequency thresholds. The resulting
heatmap shows expression patterns with gene-based row annotation and clustering options.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character vector of gene names to include in the heatmap. Can be NULL if
snp_indices is provided instead.</p></dd>


<dt id="arg-snp-indices">snp_indices<a class="anchor" aria-label="anchor" href="#arg-snp-indices"></a></dt>
<dd><p>Integer vector of specific SNP indices to include in the heatmap. Can be NULL
if genes is provided instead.</p></dd>


<dt id="arg-group-by">group.by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>Character. Column name in metadata to use for primary grouping of cells.</p></dd>


<dt id="arg-split-by">split.by<a class="anchor" aria-label="anchor" href="#arg-split-by"></a></dt>
<dd><p>Character, optional. Column name in metadata to use for secondary grouping/splitting.</p></dd>


<dt id="arg-min-alt-frac">min_alt_frac<a class="anchor" aria-label="anchor" href="#arg-min-alt-frac"></a></dt>
<dd><p>Numeric between 0 and 1. Minimum alternative allele fraction required for a SNP to be
counted as expressed in a cell. Default is 0.2.</p></dd>


<dt id="arg-scale-data">scale_data<a class="anchor" aria-label="anchor" href="#arg-scale-data"></a></dt>
<dd><p>Logical. Whether to scale data by row for visualization. Default is TRUE.</p></dd>


<dt id="arg-max-scale">max_scale<a class="anchor" aria-label="anchor" href="#arg-max-scale"></a></dt>
<dd><p>Numeric. Maximum value for scaled data (values will be capped at ±max_scale).
Default is 2.</p></dd>


<dt id="arg-cluster-rows">cluster_rows<a class="anchor" aria-label="anchor" href="#arg-cluster-rows"></a></dt>
<dd><p>Logical. Whether to cluster rows (SNPs) in the heatmap. Default is TRUE.</p></dd>


<dt id="arg-cluster-cols">cluster_cols<a class="anchor" aria-label="anchor" href="#arg-cluster-cols"></a></dt>
<dd><p>Logical. Whether to cluster columns (cell groups) in the heatmap. Default is TRUE.</p></dd>


<dt id="arg-show-rownames">show_rownames<a class="anchor" aria-label="anchor" href="#arg-show-rownames"></a></dt>
<dd><p>Logical. Whether to display row names (SNP identifiers) in the heatmap.
Default is TRUE.</p></dd>


<dt id="arg-show-colnames">show_colnames<a class="anchor" aria-label="anchor" href="#arg-show-colnames"></a></dt>
<dd><p>Logical. Whether to display column names (group identifiers) in the heatmap.
Default is TRUE.</p></dd>


<dt id="arg-fontsize-row">fontsize_row<a class="anchor" aria-label="anchor" href="#arg-fontsize-row"></a></dt>
<dd><p>Numeric. Font size for row names. Default is 8.</p></dd>


<dt id="arg-fontsize-col">fontsize_col<a class="anchor" aria-label="anchor" href="#arg-fontsize-col"></a></dt>
<dd><p>Numeric. Font size for column names. Default is 8.</p></dd>


<dt id="arg-exclude-empty">exclude_empty<a class="anchor" aria-label="anchor" href="#arg-exclude-empty"></a></dt>
<dd><p>Logical. Whether to exclude rows and columns with no expression data.
Default is TRUE.</p></dd>


<dt id="arg-normalize-by-cells">normalize_by_cells<a class="anchor" aria-label="anchor" href="#arg-normalize-by-cells"></a></dt>
<dd><p>Logical. Whether to normalize expression values by total cell count in
each group (TRUE) or only by expressing cells (FALSE). Default is TRUE.</p></dd>


<dt id="arg-data-out">data_out<a class="anchor" aria-label="anchor" href="#arg-data-out"></a></dt>
<dd><p>Logical. Whether to return the underlying data matrices instead of the heatmap
object. Default is FALSE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If data_out is FALSE (default), returns a ComplexHeatmap object that can be directly
plotted or further customized. If data_out is TRUE, returns a list containing:</p><ul><li><p>raw_matrix: Matrix of raw expression values</p></li>
<li><p>scaled_matrix: Matrix of scaled expression values</p></li>
<li><p>cell_counts: Matrix of total cell counts per group</p></li>
<li><p>expr_cell_counts: Matrix of expressing cell counts per group</p></li>
<li><p>snp_info: Data frame with SNP identifiers, gene names, and feature types</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function calculates the mean expression of SNPs across cell groups, with filtering based
on minimum alternative allele frequency. For each SNP in each group, it computes:</p><ol><li><p>The number of cells with the SNP</p></li>
<li><p>The number of cells expressing the SNP above the alt_frac threshold</p></li>
<li><p>The mean expression value (normalized by total cells or expressing cells)</p></li>
</ol><p>The resulting heatmap includes annotation for gene names and feature types, with rows grouped
by gene. The heatmap uses a blue-to-red color scale for scaled expression values.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="aggregateByGroup.html">aggregateByGroup</a></code> for aggregating SNP data by groups
<code><a href="findSNPsByGroup.html">findSNPsByGroup</a></code> for identifying differential SNPs between groups
<code><a href="plotSNPs.html">plotSNPs</a></code> for visualizing SNP distribution along genomic regions</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">plotSNPHeatmap</span><span class="op">(</span>genes <span class="op">=</span> <span class="st">"BRCA1"</span>, group.by <span class="op">=</span> <span class="st">"cell_type"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot multiple genes with custom settings</span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">plotSNPHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TP53"</span>, <span class="st">"KRAS"</span>, <span class="st">"EGFR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"cell_type"</span>,</span></span>
<span class="r-in"><span>  split.by <span class="op">=</span> <span class="st">"patient"</span>,</span></span>
<span class="r-in"><span>  min_alt_frac <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return the underlying data for custom processing</span></span></span>
<span class="r-in"><span><span class="va">snp_data</span> <span class="op">&lt;-</span> <span class="va">project</span><span class="op">$</span><span class="fu">plotSNPHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genes <span class="op">=</span> <span class="st">"APOE"</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"condition"</span>,</span></span>
<span class="r-in"><span>  data_out <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrew Potter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

