<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build a unified SNP database from all samples — buildSNPDatabase • variantCell</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build a unified SNP database from all samples — buildSNPDatabase"><meta name="description" content="Integrates SNP data, annotations, and cell metadata from all samples in the variantCell project
into a unified database. This function creates merged sparse matrices for alternative allele (AD)
and depth (DP) counts across all cells, combines cell metadata, annotates SNPs with genomic
features, and calculates database-wide metrics."><meta property="og:description" content="Integrates SNP data, annotations, and cell metadata from all samples in the variantCell project
into a unified database. This function creates merged sparse matrices for alternative allele (AD)
and depth (DP) counts across all cells, combines cell metadata, annotates SNPs with genomic
features, and calculates database-wide metrics."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">variantCell</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/build_snp_database.html">Building the SNP database</a></li>
    <li><a class="dropdown-item" href="../articles/cell_level_DE.html">Cell-level DE SNP Analsyis</a></li>
    <li><a class="dropdown-item" href="../articles/donor_recipient.html">Determining Donor and Recipient Cells</a></li>
    <li><a class="dropdown-item" href="../articles/group_level_DE.html">Group-level DE SNP Analsyis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Build a unified SNP database from all samples</h1>

      <div class="d-none name"><code>buildSNPDatabase.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Integrates SNP data, annotations, and cell metadata from all samples in the variantCell project
into a unified database. This function creates merged sparse matrices for alternative allele (AD)
and depth (DP) counts across all cells, combines cell metadata, annotates SNPs with genomic
features, and calculates database-wide metrics.</p>
    </div>


    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns self (the variantCell object) with the unified SNP database constructed
and stored in the snp_database field.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs several key steps:</p><ol><li><p>Collects SNP information across all samples and identifies unique SNPs</p></li>
<li><p>Retrieves genomic annotations for all SNPs (exonic, intronic, promoter, etc.)</p></li>
<li><p>Combines metadata from all samples, handling missing columns appropriately</p></li>
<li><p>Creates unified sparse matrices for AD and DP counts across all cells</p></li>
<li><p>If available, also creates a matrix of normalized counts</p></li>
<li><p>Calculates database-wide metrics for each SNP</p></li>
<li><p>Generates a QC report with summary statistics</p></li>
</ol><p>The function handles the complexities of integrating data from multiple samples with
potentially different sets of SNPs and metadata columns. It manages matrix indexing,
column alignment, and other technical aspects needed to build a cohesive database.</p>
<p>After running this function, all subsequent analyses (differential expression, plotting,
etc.) will use the unified database rather than individual sample data.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>This function must be called after adding all desired samples with <code><a href="addSampleData.html">addSampleData()</a></code></p></li>
<li><p>The function requires at least one sample to be added</p></li>
<li><p>SNP annotation may take significant time for large datasets</p></li>
<li><p>The resulting database can use substantial memory for projects with many cells and SNPs</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Initialize a variantCell project</span></span></span>
<span class="r-in"><span><span class="va">project</span> <span class="op">&lt;-</span> <span class="va"><a href="variantCell-package.html">variantCell</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add samples</span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">addSampleData</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">addSampleData</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Build the unified SNP database</span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">buildSNPDatabase</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now the project is ready for analysis</span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">setProjectIdentity</span><span class="op">(</span><span class="st">"cell_type"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">project</span><span class="op">$</span><span class="fu">findDESNPs</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Potter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

