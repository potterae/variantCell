<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>findDESNPs: Cell-Level Differential SNP Expression Analysis — findDESNPs • variantCell</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="findDESNPs: Cell-Level Differential SNP Expression Analysis — findDESNPs"><meta name="description" content="Identifies differentially expressed SNPs between cell populations by comparing read depths
and alternative allele frequencies. This function performs comprehensive statistical analysis
at the single-cell level, with support for parallel processing to improve performance on large datasets."><meta property="og:description" content="Identifies differentially expressed SNPs between cell populations by comparing read depths
and alternative allele frequencies. This function performs comprehensive statistical analysis
at the single-cell level, with support for parallel processing to improve performance on large datasets."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">variantCell</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/build_snp_database.html">Building the SNP database</a></li>
    <li><a class="dropdown-item" href="../articles/cell_level_DE.html">Cell-level DE SNP Analsyis</a></li>
    <li><a class="dropdown-item" href="../articles/donor_recipient.html">Determining Donor and Recipient Cells</a></li>
    <li><a class="dropdown-item" href="../articles/group_level_DE.html">Group-level DE SNP Analsyis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>findDESNPs: Cell-Level Differential SNP Expression Analysis</h1>

      <div class="d-none name"><code>findDESNPs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identifies differentially expressed SNPs between cell populations by comparing read depths
and alternative allele frequencies. This function performs comprehensive statistical analysis
at the single-cell level, with support for parallel processing to improve performance on large datasets.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ident-">ident.1<a class="anchor" aria-label="anchor" href="#arg-ident-"></a></dt>
<dd><p>Character. Primary cell identity to analyze.</p></dd>


<dt id="arg-ident-">ident.2<a class="anchor" aria-label="anchor" href="#arg-ident-"></a></dt>
<dd><p>Character, optional. Secondary cell identity to compare against.
If NULL, compares against all other cells.</p></dd>


<dt id="arg-donor-type">donor_type<a class="anchor" aria-label="anchor" href="#arg-donor-type"></a></dt>
<dd><p>Character, optional. Donor type to restrict analysis to ("Donor" or "Recipient").
If NULL, uses all cells regardless of donor type.</p></dd>


<dt id="arg-use-normalized">use_normalized<a class="anchor" aria-label="anchor" href="#arg-use-normalized"></a></dt>
<dd><p>Logical. Whether to use normalized depth counts (TRUE) or raw counts (FALSE).</p></dd>


<dt id="arg-min-expr-cells">min_expr_cells<a class="anchor" aria-label="anchor" href="#arg-min-expr-cells"></a></dt>
<dd><p>Integer. Minimum number of expressing cells required in each group.</p></dd>


<dt id="arg-min-alt-frac">min_alt_frac<a class="anchor" aria-label="anchor" href="#arg-min-alt-frac"></a></dt>
<dd><p>Numeric between 0 and 1. Minimum alternative allele fraction to consider a cell as expressing.</p></dd>


<dt id="arg-logfc-threshold">logfc.threshold<a class="anchor" aria-label="anchor" href="#arg-logfc-threshold"></a></dt>
<dd><p>Numeric. Minimum absolute log2 fold-change required to report a SNP.</p></dd>


<dt id="arg-calc-p">calc_p<a class="anchor" aria-label="anchor" href="#arg-calc-p"></a></dt>
<dd><p>Logical. Whether to calculate p-values (Wilcoxon test). Set to FALSE to save computation time.</p></dd>


<dt id="arg-p-adjust-method">p.adjust.method<a class="anchor" aria-label="anchor" href="#arg-p-adjust-method"></a></dt>
<dd><p>Character. Method for p-value adjustment, passed to p.adjust(). Default: "BH" (Benjamini-Hochberg).</p></dd>


<dt id="arg-return-all">return_all<a class="anchor" aria-label="anchor" href="#arg-return-all"></a></dt>
<dd><p>Logical. Whether to return all SNPs or only significant ones.</p></dd>


<dt id="arg-pseudocount">pseudocount<a class="anchor" aria-label="anchor" href="#arg-pseudocount"></a></dt>
<dd><p>Numeric. Value added to expression values before log transformation.</p></dd>


<dt id="arg-min-p">min.p<a class="anchor" aria-label="anchor" href="#arg-min-p"></a></dt>
<dd><p>Numeric. Minimum p-value to report (prevents numerical underflow).</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>Logical. Whether to print debugging information during analysis.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer, optional. Number of CPU cores to use for parallel processing.
If NULL, automatically uses detectCores() - 1.</p></dd>


<dt id="arg-use-parallel">use_parallel<a class="anchor" aria-label="anchor" href="#arg-use-parallel"></a></dt>
<dd><p>Logical. Whether to implement parallel processing.</p></dd>


<dt id="arg-chunk-size">chunk_size<a class="anchor" aria-label="anchor" href="#arg-chunk-size"></a></dt>
<dd><p>Integer.   Number of SNPs to process in each batch during parallel execution.
Larger values may improve performance but require more memory.</p></dd>


<dt id="arg-max-ram-gb">max_ram_gb<a class="anchor" aria-label="anchor" href="#arg-max-ram-gb"></a></dt>
<dd><p>Numeric.  Maximum RAM usage estimate in gigabytes for parallel processing.
The function will automatically reduce chunk_size if estimated memory usage
would exceed this limit.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List containing:</p>
<dl><dt>results</dt>
<dd><p>Data frame of differentially expressed SNPs with metrics including log2FC,
expression values, cell counts, and significance statistics.</p></dd>

<dt>summary</dt>
<dd><p>List with analysis overview, including counts of significant SNPs,
up/downregulated SNPs, and parameter settings used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function calculates differential expression by comparing the average expression
of SNPs between two groups, normalized by the total number of cells in each group.
For each SNP, cells are only considered as expressing if they have a minimum
alternative allele fraction (min_alt_frac) and positive read depth.</p>
<p>Statistical testing is performed using Wilcoxon rank-sum test when calc_p=TRUE.
Multiple testing correction is applied using the specified p.adjust.method.</p>
<p>The parallel implementation distributes SNP processing across multiple CPU cores
for significantly improved performance on large datasets.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>Requires package 'parallel', 'foreach', and 'doParallel' for parallel processing</p></li>
<li><p>Project identity must be set before using this function via setProjectIdentity()</p></li>
<li><p>For non-transplant datasets, donor_type filtering is automatically disabled</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="setProjectIdentity.html">setProjectIdentity</a></code> for setting the cell identity to use
<code><a href="findSNPsByGroup.html">findSNPsByGroup</a></code> for group-level SNP analysis</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Initialize a variantCell project</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">proj</span><span class="op">$</span><span class="fu">setProjectIdentity</span><span class="op">(</span><span class="st">'cell_type'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic usage comparing T cells vs other cells, donor cells only</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">proj</span><span class="op">$</span><span class="fu">findDESNPs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ident.1 <span class="op">=</span> <span class="st">"T_cells"</span>,</span></span>
<span class="r-in"><span>  ident.2 <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  donor_type <span class="op">=</span> <span class="st">"Donor"</span>,</span></span>
<span class="r-in"><span>  min_expr_cells <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  logfc.threshold <span class="op">=</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Without p-value calculation for faster processing</span></span></span>
<span class="r-in"><span><span class="va">fast_results</span> <span class="op">&lt;-</span> <span class="va">proj</span><span class="op">$</span><span class="fu">findDESNPs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ident.1 <span class="op">=</span> <span class="st">"CD4"</span>,</span></span>
<span class="r-in"><span>  ident.2 <span class="op">=</span> <span class="st">"CD8"</span>,</span></span>
<span class="r-in"><span>  calc_p <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  n_cores <span class="op">=</span> <span class="fl">8</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">summary</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Potter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

