<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>plotSNPHeatmap: Create a heatmap visualization of SNP expression across cell groups — plotSNPHeatmap • variantCell</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="plotSNPHeatmap: Create a heatmap visualization of SNP expression across cell groups — plotSNPHeatmap"><meta name="description" content="This function generates a heatmap visualization of SNP expression data across different cell
groups, with optional splitting by an additional variable. It aggregates SNP read counts within
each group and can filter based on alternative allele frequency thresholds. The resulting
heatmap shows expression patterns with gene-based row annotation and clustering options."><meta property="og:description" content="This function generates a heatmap visualization of SNP expression data across different cell
groups, with optional splitting by an additional variable. It aggregates SNP read counts within
each group and can filter based on alternative allele frequency thresholds. The resulting
heatmap shows expression patterns with gene-based row annotation and clustering options."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">variantCell</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/build_snp_database.html">Building the SNP database</a></li>
    <li><a class="dropdown-item" href="../articles/cell_level_DE.html">Cell-level DE SNP Analsyis</a></li>
    <li><a class="dropdown-item" href="../articles/donor_recipient.html">Determining Donor and Recipient Cells</a></li>
    <li><a class="dropdown-item" href="../articles/group_level_DE.html">Group-level DE SNP Analsyis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>plotSNPHeatmap: Create a heatmap visualization of SNP expression across cell groups</h1>

      <div class="d-none name"><code>plotSNPHeatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a heatmap visualization of SNP expression data across different cell
groups, with optional splitting by an additional variable. It aggregates SNP read counts within
each group and can filter based on alternative allele frequency thresholds. The resulting
heatmap shows expression patterns with gene-based row annotation and clustering options.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character vector of gene names to include in the heatmap. Can be NULL if
snp_indices is provided instead.</p></dd>


<dt id="arg-snp-indices">snp_indices<a class="anchor" aria-label="anchor" href="#arg-snp-indices"></a></dt>
<dd><p>Integer vector of specific SNP indices to include in the heatmap. Can be NULL
if genes is provided instead.</p></dd>


<dt id="arg-group-by">group.by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>Character. Column name in metadata to use for primary grouping of cells.</p></dd>


<dt id="arg-split-by">split.by<a class="anchor" aria-label="anchor" href="#arg-split-by"></a></dt>
<dd><p>Character, optional. Column name in metadata to use for secondary grouping/splitting.</p></dd>


<dt id="arg-min-alt-frac">min_alt_frac<a class="anchor" aria-label="anchor" href="#arg-min-alt-frac"></a></dt>
<dd><p>Numeric between 0 and 1. Minimum alternative allele fraction required for a SNP to be
counted as expressed in a cell. Default is 0.2.</p></dd>


<dt id="arg-scale-data">scale_data<a class="anchor" aria-label="anchor" href="#arg-scale-data"></a></dt>
<dd><p>Logical. Whether to scale data by row for visualization. Default is TRUE.</p></dd>


<dt id="arg-max-scale">max_scale<a class="anchor" aria-label="anchor" href="#arg-max-scale"></a></dt>
<dd><p>Numeric. Maximum value for scaled data (values will be capped at ±max_scale).
Default is 2.</p></dd>


<dt id="arg-cluster-rows">cluster_rows<a class="anchor" aria-label="anchor" href="#arg-cluster-rows"></a></dt>
<dd><p>Logical. Whether to cluster rows (SNPs) in the heatmap. Default is TRUE.</p></dd>


<dt id="arg-cluster-cols">cluster_cols<a class="anchor" aria-label="anchor" href="#arg-cluster-cols"></a></dt>
<dd><p>Logical. Whether to cluster columns (cell groups) in the heatmap. Default is TRUE.</p></dd>


<dt id="arg-show-rownames">show_rownames<a class="anchor" aria-label="anchor" href="#arg-show-rownames"></a></dt>
<dd><p>Logical. Whether to display row names (SNP identifiers) in the heatmap.
Default is TRUE.</p></dd>


<dt id="arg-show-colnames">show_colnames<a class="anchor" aria-label="anchor" href="#arg-show-colnames"></a></dt>
<dd><p>Logical. Whether to display column names (group identifiers) in the heatmap.
Default is TRUE.</p></dd>


<dt id="arg-fontsize-row">fontsize_row<a class="anchor" aria-label="anchor" href="#arg-fontsize-row"></a></dt>
<dd><p>Numeric. Font size for row names. Default is 8.</p></dd>


<dt id="arg-fontsize-col">fontsize_col<a class="anchor" aria-label="anchor" href="#arg-fontsize-col"></a></dt>
<dd><p>Numeric. Font size for column names. Default is 8.</p></dd>


<dt id="arg-exclude-empty">exclude_empty<a class="anchor" aria-label="anchor" href="#arg-exclude-empty"></a></dt>
<dd><p>Logical. Whether to exclude rows and columns with no expression data.
Default is TRUE.</p></dd>


<dt id="arg-normalize-by-cells">normalize_by_cells<a class="anchor" aria-label="anchor" href="#arg-normalize-by-cells"></a></dt>
<dd><p>Logical. Whether to normalize expression values by total cell count in
each group (TRUE) or only by expressing cells (FALSE). Default is TRUE.</p></dd>


<dt id="arg-data-out">data_out<a class="anchor" aria-label="anchor" href="#arg-data-out"></a></dt>
<dd><p>Logical. Whether to return the underlying data matrices instead of the heatmap
object. Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If data_out is FALSE (default), returns a ComplexHeatmap object that can be directly
plotted or further customized. If data_out is TRUE, returns a list containing:</p><ul><li><p>raw_matrix: Matrix of raw expression values</p></li>
<li><p>scaled_matrix: Matrix of scaled expression values</p></li>
<li><p>cell_counts: Matrix of total cell counts per group</p></li>
<li><p>expr_cell_counts: Matrix of expressing cell counts per group</p></li>
<li><p>snp_info: Data frame with SNP identifiers, gene names, and feature types</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates the mean expression of SNPs across cell groups, with filtering based
on minimum alternative allele frequency. For each SNP in each group, it computes:</p><ol><li><p>The number of cells with the SNP</p></li>
<li><p>The number of cells expressing the SNP above the alt_frac threshold</p></li>
<li><p>The mean expression value (normalized by total cells or expressing cells)</p></li>
</ol><p>The resulting heatmap includes annotation for gene names and feature types, with rows grouped
by gene. The heatmap uses a blue-to-red color scale for scaled expression values.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="aggregateByGroup.html">aggregateByGroup</a></code> for aggregating SNP data by groups
<code><a href="findSNPsByGroup.html">findSNPsByGroup</a></code> for identifying differential SNPs between groups
<code><a href="plotSNPs.html">plotSNPs</a></code> for visualizing SNP distribution along genomic regions</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">plotSNPHeatmap</span><span class="op">(</span>genes <span class="op">=</span> <span class="st">"BRCA1"</span>, group.by <span class="op">=</span> <span class="st">"cell_type"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot multiple genes with custom settings</span></span></span>
<span class="r-in"><span><span class="va">project</span><span class="op">$</span><span class="fu">plotSNPHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TP53"</span>, <span class="st">"KRAS"</span>, <span class="st">"EGFR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"cell_type"</span>,</span></span>
<span class="r-in"><span>  split.by <span class="op">=</span> <span class="st">"patient"</span>,</span></span>
<span class="r-in"><span>  min_alt_frac <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return the underlying data for custom processing</span></span></span>
<span class="r-in"><span><span class="va">snp_data</span> <span class="op">&lt;-</span> <span class="va">project</span><span class="op">$</span><span class="fu">plotSNPHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genes <span class="op">=</span> <span class="st">"APOE"</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"condition"</span>,</span></span>
<span class="r-in"><span>  data_out <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Potter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

