% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/02-process-vireo.R
\name{process_vireo_sce}
\alias{process_vireo_sce}
\title{process_vireo_sce: Integrate Vireo donor assignments with a SingleCellExperiment object}
\arguments{
\item{sce_obj}{A SingleCellExperiment object. The single-cell dataset to be annotated with
donor information.}

\item{vireo_path}{Character. Path to the Vireo donor_ids.tsv file containing donor assignments.}

\item{prefix_text}{Character. Text to prepend to cell identifiers in the Vireo data to match
the cell barcodes in the SingleCellExperiment object.}
}
\value{
A list containing:
\item{sce_object}{The SingleCellExperiment object with donor assignment metadata added}
\item{donor_data}{Data frame containing donor assignments for matched cells}
\item{matching_cells}{Character vector of cell identifiers that matched between SCE and Vireo}
\item{summaries}{List of summary statistics including:
\itemize{
\item donor_summaries: Per-donor cell counts and cell type distributions (if available)
\item cells_matched: Total number of cells successfully matched
\item total_sce_cells: Total number of cells in the SingleCellExperiment object
\item total_vireo_cells: Total number of cells in the Vireo data
}
}
}
\description{
Processes donor genetic identity data from Vireo and integrates it with a SingleCellExperiment
object's metadata. The function adds donor assignments to the colData, matches cell identifiers
between Vireo output and the SCE object, and generates summary statistics of cell type
distributions per donor.
}
\details{
This function first processes the Vireo TSV file using the \code{process_tsv} function,
adding the prefix to cell identifiers. It then adds the donor assignments to the
SingleCellExperiment object's colData and generates summary statistics of cell type
distributions for each donor (if cell_type information is available in colData).
}
\note{
The function checks for a "cell_type" column in the SingleCellExperiment object's colData.
If present, it will generate cell type distribution summaries per donor. If not, the
cell_types field in donor_summaries will be NULL.
}
\examples{
\dontrun{
# Process a SingleCellExperiment object with Vireo donor assignments
results <- process_vireo_sce(
  sce_obj = my_sce_object,
  vireo_path = "path/to/vireo/donor_ids.tsv",
  prefix_text = "Patient1_Sample3_"
)

# Access the updated SingleCellExperiment object
updated_sce <- results$sce_object

# Check matching statistics
results$summaries$cells_matched
results$summaries$total_sce_cells
}
}
