% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/05-plots.R
\name{plotSNPs}
\alias{plotSNPs}
\title{plotSNPs "Visualize SNP Distribution for a Gene"}
\arguments{
\item{gene}{Character. Name of the gene to visualize.}

\item{group.by}{Character, optional. Primary grouping variable from metadata.
If NULL, all cells are treated as one group.}

\item{split.by}{Character, optional. Secondary grouping variable for within-group comparisons.
Useful for donor/recipient or condition comparisons within cell types.}

\item{idents}{Vector, optional. Specific identity values to include. Must be values from group.by column.}

\item{min_depth}{Integer. Minimum read depth required to include a SNP in visualization.}

\item{min_cells}{Integer. Minimum cells per group required to include a group in visualization.}

\item{min_alt_frac}{Numeric between 0 and 1. Minimum alternative allele fraction required to include a SNP.
Set to 0 to show all SNPs regardless of alt fraction.}

\item{flank_size}{Integer. Size of flanking regions (in bp) to include around the gene.}

\item{plot_density}{Logical. Whether to include density distribution plots below the main visualization.}

\item{data_out}{Logical. If TRUE, returns a data frame with SNP data instead of plots.}

\item{use_normalized}{Logical. Whether to use normalized read depth values.}

\item{color_scheme}{Vector. Named vector with "low" and "high" colors for alt fraction gradient.}

\item{point_size_range}{Numeric vector of length 2. Range of point sizes (minimum and maximum) for depth representation.}
}
\value{
If data_out = FALSE (default): Plot grid with main SNP visualization and optional density plots.
If data_out = TRUE: Data frame containing SNP information for the gene including positions,
alternative allele frequencies, depths, and other metrics for each group.
}
\description{
Creates genomic visualizations of SNP distribution for a specified gene, showing alternative allele
frequencies across different cell populations. This function generates interactive plots
displaying SNPs along the gene's coordinates with various grouping options.
}
\details{
This function creates a comprehensive visualization of SNPs within a gene region, showing:
\enumerate{
\item A main plot with:
\itemize{
\item Gene structure with exons displayed as black rectangles
\item SNP positions represented as points along genomic coordinates
\item Alternative allele frequencies encoded by color
\item Read depth encoded by point size
\item Groups and splits organized vertically
}
\item Optional density plots showing:
\itemize{
\item Alternative allele fraction distribution
\item Read depth distribution (log10 scale)
}
}

The function applies filters to ensure only high-quality data is displayed. SNPs with low
depth or low alternative allele frequency can be excluded. Groups with insufficient cells
are also not displayed.
}
\note{
\itemize{
\item Requires gene annotation data from AnnotationHub (automatically accessed)
\item May take longer to generate for genes with many SNPs or when using many groups
\item Setting min_alt_frac = 0 shows all SNPs but may make plots very busy
\item The data_out parameter is useful for further custom analysis or visualization
}
}
\examples{
# Basic visualization of a gene


\dontrun{

# Split by cell type and donor type
project$plotSNPs(
  gene = "IL7R",
  group.by = "cell_type",
  split.by = "donor_type",
  min_alt_frac = 0.1
)

# Focus on specific cell types
project$plotSNPs(
  gene = "PDCD1",
  group.by = "cell_type",
  idents = c("CD4_T", "CD8_T", "Treg"),
  flank_size = 10000
)

# Return data frame instead of plot for custom visualization
snp_data <- project$plotSNPs(
  gene = "HLA-DRB1",
  group.by = "condition",
  data_out = TRUE
)
}
}
\seealso{
\code{\link{findDESNPs}} for identifying differentially expressed SNPs
\code{\link{plotSNPHeatmap}} for heatmap visualization of multiple genes
}
